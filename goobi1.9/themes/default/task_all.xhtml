<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	template="/themes/default/template/template.html"
	xmlns:x="http://myfaces.apache.org/tomahawk">


	<ui:define name="breadcrumb">
		<h:commandLink id="id2" value="#{msgs.startseite}" action="index" />
		<f:verbatim> &#8250;&#8250; </f:verbatim>
		<h:outputText value="#{msgs.aktuelleSchritte}" />

	</ui:define>

	<ui:define name="title">
		<h:outputText value="#{msgs.aktuelleSchritte}" />

	</ui:define>

	<ui:define name="content">

<h:form><h4>
			<h:outputText value="#{msgs.meineAufgabenMsg}" />
		</h4>

		<!-- +++++++++++++++++  Anzeigefilter ++++++++++++++++++++++++ 

		<f:subview id="sub1">
			<ui:include src="includes/task/list_filter.xhtml" />
		</f:subview>
		-->

		<x:dataTable id="auflistung" styleClass="standardTable" width="100%"
			cellspacing="1px" cellpadding="1px"
			headerClass="standardTable_Header"
			rowClasses="standardTable_Row1,standardTable_Row2,standardTable_Row1,standardTable_Row2"
			var="item" value="#{AktuelleSchritteForm.page.listReload}">

			<!-- +++++++++++++++++  SelectionBoxes ++++++++++++++++++++++++ -->
			<x:column style="text-align:center"
				rendered="#{AktuelleSchritteForm.anzeigeAnpassen['selectionBoxes']}">
				<f:facet name="header">
					<x:div>
						<h:outputText value="#{msgs.auswahl2}" />
						<h:commandLink action="#{AktuelleSchritteForm.SelectionAll}"
							id="selectAll" title="#{msgs.alleAuswaehlen}"
							style="margin-left:10px">
							<h:graphicImage value="/newpages/images/check_true.gif" />
						</h:commandLink>
						<h:commandLink action="#{AktuelleSchritteForm.SelectionNone}"
							id="selectnone" title="#{msgs.auswahlEntfernen}"
							style="margin-left:5px">
							<h:graphicImage value="/newpages/images/check_false.gif" />
						</h:commandLink>
					</x:div>
				</f:facet>
				<h:commandLink id="myself1">
					<h:graphicImage value="/newpages/images/check_true.gif"
						style="margin-right:4px" rendered="#{item.selected}" />
					<h:graphicImage value="/newpages/images/check_false.gif"
						style="margin-right:4px" rendered="#{!item.selected}" />
					<x:updateActionListener value="#{item.selected?false:true}"
						property="#{item.selected}" />
				</h:commandLink>
			</x:column>
			

			<!-- +++++++++++++++++  ProzessID ++++++++++++++++++++++++ -->
			<x:column style="text-align:center"
				rendered="#{AktuelleSchritteForm.anzeigeAnpassen['processId']}">
				<f:facet name="header">
					<h:outputText value="#{msgs.id}" />
				</f:facet>
				<h:outputText value="#{item.prozess.id}" />
			</x:column>
			

			
 	<x:column style="text-align:left" rendered="#{true}">
				<f:facet name="header">
					<x:div>
						<!-- Header -->
						<h:outputText value="#{msgs.arbeitsschritt}" />
						<!-- Sortierung Asc -->
						<h:commandLink action="#{AktuelleSchritteForm.FilterAlleStart}"
							id="sort1"
							rendered="#{AktuelleSchritteForm.sortierung=='schrittAsc'}">
							<h:graphicImage value="/newpages/images/sorting/asc.gif"
								style="vertical-align:middle;margin-left:5px" />
							<x:updateActionListener
								property="#{AktuelleSchritteForm.sortierung}"
								value="schrittDesc" />
						</h:commandLink>
						<!-- Sortierung Desc -->
						<h:commandLink action="#{AktuelleSchritteForm.FilterAlleStart}"
							id="sort2"
							rendered="#{AktuelleSchritteForm.sortierung=='schrittDesc'}">
							<h:graphicImage value="/newpages/images/sorting/desc.gif"
								style="vertical-align:middle;margin-left:5px" />
							<x:updateActionListener
								property="#{AktuelleSchritteForm.sortierung}" value="schrittAsc" />
						</h:commandLink>
						<!-- Sortierung none -->
						<h:commandLink action="#{AktuelleSchritteForm.FilterAlleStart}"
							id="sort3"
							rendered="#{AktuelleSchritteForm.sortierung!='schrittDesc' and AktuelleSchritteForm.sortierung!='schrittAsc'}">
							<h:graphicImage value="/newpages/images/sorting/none.gif"
								style="vertical-align:middle;margin-left:5px" />
							<x:updateActionListener
								property="#{AktuelleSchritteForm.sortierung}" value="schrittAsc" />
						</h:commandLink>
					</x:div>
				</f:facet>

				<h:commandLink reRender="auflistungIntern,myself" id="myself"
					style="color:black">
					<h:graphicImage value="/newpages/images/plus.gif"
						style="margin-right:4px" rendered="#{!item.panelAusgeklappt}" />
					<h:graphicImage value="/newpages/images/minus.gif"
						style="margin-right:4px" rendered="#{item.panelAusgeklappt}" />
					<x:updateActionListener value="#{item.panelAusgeklappt?false:true}"
						property="#{item.panelAusgeklappt}" />
					<h:outputText value="#{item.titel}" />
				</h:commandLink>

				<h:panelGroup id="auflistungIntern">

					<x:div style="width:90%;margin-top;margin-left:12px;margin-top:5px"
						rendered="#{item.panelAusgeklappt}">
						<!-- Schrittdetails 
						<ui:include src="includes/task/list_details.xhtml" />
						-->
					</x:div>
				</h:panelGroup>
			</x:column>
			 	
			 	
			<!-- ===================== Action ====================== -->
			<x:column style="text-align:center" styleClass="action">
				<f:facet name="header">
					<h:outputText value="#{msgs.auswahl}" styleClass="action" />
				</f:facet>

				<!-- Bearbeitung übernehmen-Schaltknopf -->
				<h:commandLink id="take"
					action="#{AktuelleSchritteForm.SchrittDurchBenutzerUebernehmen}"
					rendered="#{(item.bearbeitungsstatusEnum == 'OPEN' and !item.batchStep) or (item.bearbeitungsstatusEnum == 'OPEN' and item.batchStep and !item.batchSize)}"
					title="#{msgs.bearbeitungDiesesSchrittsUebernehmen}">
					<h:graphicImage value="/newpages/images/buttons/admin2a.gif" />
					<x:updateActionListener
						property="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
				</h:commandLink>

				<!-- Bearbeiten-Schaltknopf (eigener Schritt) -->
				<h:commandLink action="task_edit" id="view1"
					rendered="#{(item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id and !item.batchStep) or (item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id and item.batchStep and !item.batchSize)}"
					title="#{msgs.inBearbeitungDurch}: #{item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname:''}">
					<h:graphicImage value="/newpages/images/buttons/admin1b.gif" />
					<x:updateActionListener
						property="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
				</h:commandLink>

				<!-- Bearbeiten-Schaltknopf (fremder Schritt) -->
				<h:commandLink action="task_edit" id="view2"
					rendered="#{item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id != LoginForm.myBenutzer.id and (!item.batchStep or !item.batchSize)}"
					title="#{msgs.inBearbeitungDurch}: #{(item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname : '')}">
					<h:graphicImage value="/newpages/images/buttons/admin1c.gif" />
					<x:updateActionListener
						property="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
				</h:commandLink>

				<!-- edit batch step -->
				<h:commandLink id="batch"
					action="#{AktuelleSchritteForm.TakeOverBatch}"
					rendered="#{item.bearbeitungsstatusEnum == 'OPEN' and item.batchStep and item.batchSize}"
					title="#{msgs.bearbeitungDiesesSchrittsUebernehmen}">
					<h:graphicImage value="/newpages/images/buttons/admin3a.gif" />
					<x:updateActionListener property="#{AktuelleSchritteForm.step}"
						value="#{item}" />
				</h:commandLink>
				<!-- edit batch step -->
				<h:commandLink id="batchInWork"
					action="#{AktuelleSchritteForm.BatchesEdit}"
					rendered="#{item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id and item.batchStep and item.batchSize}"
					title="#{msgs.bearbeitungDiesesSchrittsUebernehmen}">
					<h:graphicImage value="/newpages/images/buttons/admin3.gif" />
					<x:updateActionListener property="#{AktuelleSchritteForm.step}"
						value="#{item}" />
				</h:commandLink>

				<!-- edit batch step -->
				<h:commandLink id="batchInWorkOther"
					action="#{AktuelleSchritteForm.BatchesEdit}"
					rendered="#{item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id != LoginForm.myBenutzer.id and item.batchStep and item.batchSize}"
					title="#{msgs.inBearbeitungDurch}: #{(item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname : '')}">


					<h:graphicImage value="/newpages/images/buttons/admin3c.gif" />
					<x:updateActionListener property="#{AktuelleSchritteForm.step}"
						value="#{item}" />
				</h:commandLink>
			</x:column>
			<!-- ===================== // Action ====================== -->
			
		</x:dataTable>

<!-- ===================== Datascroller für die Ergebnisse ======================
		 -->
		<x:aliasBean alias="#{mypage}" value="#{AktuelleSchritteForm.page}">
			<ui:include src="includes/datascroller.xhtml" />
		</x:aliasBean>
		<!-- ===================== // Datascroller für die Ergebnisse ====================== -->

		<!-- Schritte auflisten -->
		<ui:include src="includes/task/list_action.xhtml" />
		
		
</h:form>
		
	</ui:define>

</ui:composition>