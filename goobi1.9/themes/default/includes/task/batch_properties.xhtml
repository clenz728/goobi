<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:x="http://myfaces.apache.org/tomahawk"
	xmlns:s="http://myfaces.apache.org/sandbox">

	<composite:interface>
	</composite:interface>

	<composite:implementation>

		<h:form id="propform2"
			rendered="#{AktuelleSchritteForm.batchHelper.propertyListSize>0}">
			<h4>
				<h:outputText value="#{msgs.erweiterteEigenschaften}" />
			</h4>
			<!-- Box für die Bearbeitung der Details -->
			<h:panelGroup
				rendered="#{AktuelleSchritteForm.modusBearbeiten!='eigenschaft' && AktuelleSchritteForm.batchHelper.propertyListSize>0}">


				<table cellspacing="1px" cellpadding="1px" width="100%"
					class="standardTable">

					<thead class="standardTable_Header">
						<th><h:outputText value="#{msgs.titel}" /></th>
						<th><h:outputText value="#{msgs.wert}" /></th>
						<th><h:outputText value="#{msgs.auswahl}" /></th>
					</thead>


					<x:dataList var="container"
						value="#{AktuelleSchritteForm.batchHelper.containerList}"
						rowCountVar="rowCount" rowIndexVar="rowIndex">
						<x:dataList var="proc"
							value="#{AktuelleSchritteForm.batchHelper.containerlessProperties}"
							rowCountVar="propCount" rowIndexVar="propInd">

							<h:panelGroup rendered="#{container!=0 }">
								<tr class="standardTable_Row1">
									<td><h:outputText value="#{proc.name}" /></td>
									<td><h:outputText value="#{proc.value}" /></td>
									<td class="standardTable_ColumnCentered"><h:commandLink
											action="task_batch_edit" title="#{msgs.bearbeiten}"
											rendered="#{AktuelleSchritteForm.batchHelper.currentStep.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id}">
											<h:graphicImage value="/newpages/images/buttons/edit.gif" />
											<x:updateActionListener
												property="#{AktuelleSchritteForm.batchHelper.processProperty}"
												value="#{proc}" />
											<x:updateActionListener
												property="#{AktuelleSchritteForm.batchHelper.container}"
												value="0" />
											<x:updateActionListener
												property="#{AktuelleSchritteForm.modusBearbeiten}"
												value="eigenschaft" />
										</h:commandLink></td>
								</tr>
							</h:panelGroup>
						</x:dataList>

						<h:panelGroup rendered="#{rowIndex < rowCount && rowIndex != 0}">
							<tr>
								<td colspan="3" class="standardTable_Row1"><h:outputText
										value="&nbsp;" escape="false" /></td>
							</tr>
						</h:panelGroup>

						<x:dataList var="process_item"
							value="#{AktuelleSchritteForm.batchHelper.containers[container].propertyList}"
							rowCountVar="propCount" rowIndexVar="propInd">

							<h:panelGroup rendered="#{container!=0 }">

								<tr class="standardTable_Row1">
									<td><h:outputText value="#{process_item.name}" /></td>
									<td><h:outputText value="#{process_item.value}" /></td>

									<h:panelGroup rendered="#{propInd ==0}">

										<td class="standardTable_ColumnCentered"
											rowspan="#{AktuelleSchritteForm.containers[container].propertyListSizeString}">
											<!-- edit container --> <h:panelGroup
												rendered="#{AktuelleSchritteForm.batchHelper.currentStep.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id}">
												<h:commandLink action="task_batch_edit"
													title="#{msgs.bearbeiten}">
													<h:graphicImage value="/newpages/images/buttons/edit.gif" />
													<x:updateActionListener
														property="#{AktuelleSchritteForm.batchHelper.container}"
														value="#{container}" />
													<x:updateActionListener
														property="#{AktuelleSchritteForm.modusBearbeiten}"
														value="eigenschaft" />
												</h:commandLink>

											</h:panelGroup>
										</td>
									</h:panelGroup>
								</tr>
							</h:panelGroup>
						</x:dataList>
					</x:dataList>




					<!-- 
	<h:outputText value="Nummer: #{container}" />
		<h:outputText value="  Anzahl: #{AktuelleSchritteForm.batchHelper.containers[container]}" />
		<br />
		rendered="#{propInd + 1 == propCount}"
-->

				</table>
			</h:panelGroup>

			<!-- 

    <x:dataList var="container" value="#{AktuelleSchritteForm.batchHelper.containers}" rowCountVar="rowCount" rowIndexVar="rowIndex">
            <x:dataList var="proc" value="#{AktuelleSchritteForm.batchHelper.containerlessProperties}" rowCountVar="propCount" rowIndexVar="propInd">
                <tr rendered="#{container == 0}" class="standardTable_Row1">
                    <td>
                       
                        <h:outputText value="#{proc.name}" />
                    </td>
                    <td>
                        <h:outputText value="#{proc.value}" />
                    </td>
                    <td class="standardTable_ColumnCentered">

                        <h:commandLink action="BatchesEdit" title="#{msgs.bearbeiten}"
                            rendered="#{AktuelleSchritteForm.batchHelper.currentStep.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id}">
                            <h:graphicImage value="/newpages/images/buttons/edit.gif" />
                            <x:updateActionListener property="#{AktuelleSchritteForm.batchHelper.processProperty}" value="#{proc}" />
                            <x:updateActionListener property="#{BatchForm.batchHelper.container}" value="0" />
                            <x:updateActionListener property="#{AktuelleSchritteForm.modusBearbeiten}" value="eigenschaft" />
                            <a4j:support event="onchange" reRender="editBatch" />
                        </h:commandLink>

                        <h:commandLink action="#{AktuelleSchritteForm.batchHelper.duplicateContainerForAll}" title="#{msgs.duplicateForAll}"
                            rendered="#{AktuelleSchritteForm.batchHelper.currentStep.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id}">
                            <h:graphicImage value="/newpages/images/buttons/copy.gif" />
                            <x:updateActionListener property="#{AktuelleSchritteForm.batchHelper.processProperty}" value="#{proc}" />
                        </h:commandLink>
                    </td>
                </tr>
            </x:dataList>

            <x:dataList var="process_item" value="#{AktuelleSchritteForm.batchHelper.sortedProperties}" rowCountVar="propCount" rowIndexVar="propInd">

                <tr rendered="#{container != 0 && process_item.container==container}" class="standardTable_Row1">

                    <td>
                        <h:outputText value="#{process_item.name}" />
                    </td>
                    <td>
                        <h:outputText value="#{process_item.value}" />
                    </td>

                    <td class="standardTable_ColumnCentered">
                        <h:panelGroup
                            rendered="#{AktuelleSchritteForm.batchHelper.currentStep.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id && propInd + 1 == propCount}">
                            <h:commandLink action="BatchesEdit" title="#{msgs.bearbeiten}">
                                <h:graphicImage value="/newpages/images/buttons/edit.gif" />
                                <x:updateActionListener property="#{AktuelleSchritteForm.batchHelper.container}" value="#{container}" />
                                <x:updateActionListener property="#{AktuelleSchritteForm.modusBearbeiten}" value="eigenschaft" />
                                <a4j:support event="onchange" reRender="editBatch" />
                            </h:commandLink>
                            <h:commandLink action="#{AktuelleSchritteForm.batchHelper.duplicateContainerForAll}" title="#{msgs.duplicateForAll}">
                                <h:graphicImage value="/newpages/images/buttons/copy.gif" />
                                <x:updateActionListener property="#{AktuelleSchritteForm.batchHelper.container}" value="#{container}" />
                            </h:commandLink>
                        </h:panelGroup>
                    </td>

                </tr>
            </x:dataList>

            <tr rendered="#{rowIndex + 1 < rowCount}">
                <td colspan="3" class="standardTable_Row1">
                    <h:outputText value="&nbsp;" escape="false" />
                </td>
            </tr>
        </x:dataList>
-->

			<!-- Box für die Bearbeitung der Details -->
			<h:panelGroup rendered="#{AktuelleSchritteForm.modusBearbeiten=='eigenschaft' && AktuelleSchritteForm.batchHelper.currentStep.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id}">
			
			<table cellpadding="3" cellspacing="0" width="100%"
				class="eingabeBoxen"
				>

				<tr>
					<td class="eingabeBoxen_row1" colspan="2"><h:outputText
							value="#{msgs.eigenschaft}" /></td>
				</tr>

				<!-- Formular für die Bearbeitung der Eigenschaft -->
				<tr>
					<td class="eingabeBoxen_row2" colspan="2">
						<table>

							<x:dataList var="myprocess_item"
								value="#{AktuelleSchritteForm.batchHelper.containerProperties}">

								<!-- 	<x:aliasBean alias="#{myprocess_item}" value="#{AktuelleSchritteForm.batchHelper.processProperty}">-->
								<tr>
									<td><h:outputText id="eigenschafttitel"
											style="width: 500px;margin-right:15px"
											value="#{myprocess_item.name}: " /></td>
									<td>
										<!-- textarea --> <h:panelGroup id="prpvw15_1"
											rendered="#{((myprocess_item.type.name == 'text') || (myprocess_item.type.name == 'null'))}">
											<h:inputText id="file" style="width: 500px;margin-right:15px"
												value="#{myprocess_item.value}" />
										</h:panelGroup> <!-- numbers only --> <h:panelGroup id="prpvw15_1mnk"
											rendered="#{myprocess_item.type.name == 'integer' || myprocess_item.type.name == 'number'}">

											<h:inputText id="numberstuff122334mnktodo"
												style="width: 500px;margin-right:15px"
												value="#{myprocess_item.value}">
												<f:validateLongRange minimum="0" />
											</h:inputText>
										</h:panelGroup> <!--  SelectOneMenu --> <h:panelGroup id="prpvw15_2"
											rendered="#{(myprocess_item.type.name == 'list')}">
											<h:selectOneMenu value="#{myprocess_item.value}"
												style="width: 500px;margin-right:15px" id="prpvw15_2_1">
												<f:selectItems id="prpvw15_2_2"
													value="#{myprocess_item.possibleValues}"
													var="myprocess_items" itemLabel="#{myprocess_items}"
													itemValue="#{myprocess_items}" />
											</h:selectOneMenu>
										</h:panelGroup> <!--  SelectManyMenu --> <h:panelGroup id="prpvw15_3"
											rendered="#{(myprocess_item.type.name == 'listmultiselect')}">
											<h:selectManyListbox id="prpvw15_3_1"
												style="width: 500px;margin-right:15px"
												value="#{myprocess_item.valueList}" size="5">
												<f:selectItems id="prpvw15_3_2"
													value="#{myprocess_item.possibleValues}"
													var="myprocess_items" itemLabel="#{myprocess_items}"
													itemValue="#{myprocess_items}" />
											</h:selectManyListbox>
										</h:panelGroup> <!--  Boolean --> <h:panelGroup id="prpvw15_4"
											rendered="#{(myprocess_item.type.name == 'boolean')}">
											<h:selectBooleanCheckbox
												value="#{myprocess_item.booleanValue}" />
										</h:panelGroup> <!--  Date  --> <h:panelGroup id="prpvw15_5"
											rendered="#{(myprocess_item.type.name == 'date')}">
											<x:inputCalendar id="prpvw15_5_1"
													value="#{myprocess_item.dateValue}" style="width:110px"
													renderAsPopup="true" renderPopupButtonAsImage="true"
													popupTodayString="#{msgs.heute}"
													popupWeekString="#{msgs.kw}"
													styleClass="projekteBearbeiten"
													imageLocation="/newpages/images/calendarImages"
													popupButtonImageUrl="/newpages/images/calendarImages/calendar.gif">
												</x:inputCalendar>
										</h:panelGroup>

									</td>
								</tr>
							</x:dataList>
						</table>
					</td>
				</tr>

				<tr>
					<td class="eingabeBoxen_row3" align="left"><h:commandButton
							value="#{msgs.abbrechen}" action="#{NavigationForm.Reload}"
							immediate="true">
							<x:updateActionListener
								property="#{AktuelleSchritteForm.modusBearbeiten}" value="" />
						</h:commandButton></td>
					<td class="eingabeBoxen_row3" align="right">
						<!-- 
				<h:commandButton value="#{msgs.loeschen}" action="#{AktuelleSchritteForm.deleteProperty}"
					onclick="return confirm('#{msgs.sollDieserEintragWirklichGeloeschtWerden}?')">
					<x:updateActionListener property="#{AktuelleSchritteForm.modusBearbeiten}" value="" />
				</h:commandButton>
			--> <h:commandButton value="#{msgs.applyToThisProcess}"
							action="#{AktuelleSchritteForm.batchHelper.saveCurrentProperty}">

							<x:updateActionListener
								property="#{AktuelleSchritteForm.modusBearbeiten}" value="" />
						</h:commandButton> <h:commandButton value="#{msgs.applyToAllProcesses}"
							action="#{AktuelleSchritteForm.batchHelper.saveCurrentPropertyForAll}">
							<x:updateActionListener
								property="#{AktuelleSchritteForm.modusBearbeiten}" value="" />
						</h:commandButton>
					</td>
				</tr>
			</table>
			</h:panelGroup>

		</h:form>

	</composite:implementation>

</ui:composition>


