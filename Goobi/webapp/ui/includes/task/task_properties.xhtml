<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:composite="http://xmlns.jcp.org/jsf/composite"
    xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:x="http://myfaces.apache.org/tomahawk"
    xmlns:s="http://myfaces.apache.org/sandbox">

    <composite:interface>
    </composite:interface>

    <composite:implementation>
        <br />
        <h:form id="propform2" rendered="#{AktuelleSchritteForm.propertyListSize>0}">

            <h:panelGroup rendered="#{AktuelleSchritteForm.modusBearbeiten!='eigenschaft' and AktuelleSchritteForm.propertyListSize>0}">

                <table cellspacing="1px" cellpadding="1px" width="100%" class="standardTable">

                    <thead class="standardTable_Header">
                        <th>
                            <h:outputText value="#{msgs.titel}" />
                        </th>
                        <th>
                            <h:outputText value="#{msgs.wert}" />
                        </th>
                        <th>
                            <h:outputText value="#{msgs.auswahl}" />
                        </th>
                    </thead>
                    <x:dataList var="container" value="#{AktuelleSchritteForm.containerList}" rowCountVar="rowCount" rowIndexVar="rowIndex">
                        <x:dataList var="proc" value="#{AktuelleSchritteForm.containerlessProperties}" rowCountVar="propCount" rowIndexVar="propInd">

                            <h:panelGroup rendered="#{container==0 }">
                                <tr class="standardTable_Row1">
                                    <td>
                                        <h:outputText value="#{proc.name}" />
                                    </td>
                                    <td>
                                        <h:outputText value="#{proc.value}" rendered="#{proc.type.name != 'link'}" />
                                        <h:outputLink value="#{proc.value}" title="#{proc.value}" target="_blank"
                                            rendered="#{proc.type.name == 'link'}">
                                            <h:outputText value="#{proc.value}" />
                                        </h:outputLink>
                                    </td>
                                    <td class="standardTable_ColumnCentered">
                                        <h:commandLink action="task_edit" title="#{msgs.bearbeiten}"
                                            rendered="#{AktuelleSchritteForm.mySchritt.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id}">
                                            <h:graphicImage value="images/buttons/edit.gif" />
                                            <x:updateActionListener property="#{AktuelleSchritteForm.processProperty}" value="#{proc}" />
                                            <x:updateActionListener property="#{AktuelleSchritteForm.container}" value="0" />
                                            <x:updateActionListener property="#{AktuelleSchritteForm.modusBearbeiten}" value="eigenschaft" />
                                        </h:commandLink>

                                        <h:commandLink action="#{AktuelleSchritteForm.duplicateProperty}" title="#{msgs.duplicate}"
                                            rendered="#{proc.duplicationAllowed and AktuelleSchritteForm.mySchritt.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id}">
                                            <h:graphicImage value="images/buttons/copy.gif" />
                                            <x:updateActionListener property="#{AktuelleSchritteForm.processProperty}" value="#{proc}" />
                                            <x:updateActionListener property="#{AktuelleSchritteForm.container}" value="0" />
                                        </h:commandLink>

                                    </td>
                                </tr>
                            </h:panelGroup>
                        </x:dataList>

                        <h:panelGroup rendered="#{rowIndex lt rowCount and rowIndex != 0}">

                            <tr>
                                <td colspan="3" class="standardTable_Row1">
                                    <h:outputText value="" escape="false" />
                                </td>
                            </tr>
                        </h:panelGroup>

                        <x:dataList var="process_item" value="#{AktuelleSchritteForm.containers[container].propertyList}" rowCountVar="propCount"
                            rowIndexVar="propInd">

                            <h:panelGroup rendered="#{container!=0 }">
                                <tr class="standardTable_Row1">
                                    <td>
                                        <h:outputText value="#{process_item.name}" />
                                    </td>
                                    <td>
                                        <h:outputText value="#{process_item.value}" />
                                    </td>
                                    <h:panelGroup rendered="#{propInd ==0}">

                                        <td class="standardTable_ColumnCentered"
                                            rowspan="#{AktuelleSchritteForm.containers[container].propertyListSizeString}">
                                            <h:panelGroup
                                                rendered="#{AktuelleSchritteForm.mySchritt.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id}">
                                                <h:commandLink action="task_edit" title="#{msgs.bearbeiten}">
                                                    <h:graphicImage value="images/buttons/edit.gif" />
                                                    <x:updateActionListener property="#{AktuelleSchritteForm.container}" value="#{container}" />
                                                    <x:updateActionListener property="#{AktuelleSchritteForm.modusBearbeiten}" value="eigenschaft" />
                                                </h:commandLink>
                                                
                                                <h:commandLink action="#{AktuelleSchritteForm.duplicateContainer}" title="#{msgs.duplicate}"
                                                    rendered="#{process_item.duplicationAllowed}">
                                                    <h:graphicImage value="images/buttons/copy.gif" />
                                                    <x:updateActionListener property="#{AktuelleSchritteForm.container}" value="#{container}" />
                                                </h:commandLink>

                                            </h:panelGroup>
                                        </td>
                                    </h:panelGroup>
                                </tr>
                            </h:panelGroup>
                        </x:dataList>

                    </x:dataList>
                </table>
            </h:panelGroup>

            <h:panelGroup
                rendered="#{AktuelleSchritteForm.modusBearbeiten=='eigenschaft' and AktuelleSchritteForm.mySchritt.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id}">


                <table cellpadding="3" cellspacing="0" width="100%" class="eingabeBoxen">

                    <tr>
                        <td class="eingabeBoxen_row1" colspan="2">
                            <h:outputText value="#{msgs.eigenschaft}" />
                        </td>
                    </tr>

                    <!-- Formular fÃ¼r die Bearbeitung der Eigenschaft -->
                    <tr>
                        <td class="eingabeBoxen_row2" colspan="2">
                            <table>

                                <x:dataList var="myprocess_item" value="#{AktuelleSchritteForm.containerProperties}">

                                    <!-- 	<x:aliasBean alias="#{myprocess_item}" value="#{AktuelleSchritteForm.processProperty}">-->
                                    <tr>
                                        <td>
                                            <h:outputText id="eigenschafttitel" style="width: 500px;margin-right:15px"
                                                value="#{myprocess_item.name}: " />
                                        </td>
                                        <td>
                                            <!-- textarea -->
                                            <h:panelGroup
                                                rendered="#{((myprocess_item.type.name == 'text') or (myprocess_item.type.name == 'link') or (myprocess_item.type.name == 'null'))}">
                                                <h:inputText style="width: 500px;margin-right:15px" value="#{myprocess_item.value}"
                                                    readonly="#{myprocess_item.currentStepAccessCondition == 'READ'}" />
                                            </h:panelGroup>
                                            <!-- numbers only -->
                                            <h:panelGroup 
                                                rendered="#{myprocess_item.type.name == 'integer' or myprocess_item.type.name == 'number'}">
                                                <h:inputText  style="width: 500px;margin-right:15px" id="number"
                                                    value="#{myprocess_item.value}"
                                                    readonly="#{myprocess_item.currentStepAccessCondition == 'READ'}">
                                                    <f:validateLongRange minimum="0" />
                                                </h:inputText>
                                            </h:panelGroup>
                                            <!--  SelectOneMenu -->
                                            <h:panelGroup  rendered="#{(myprocess_item.type.name == 'list')}">
                                                <h:selectOneMenu value="#{myprocess_item.value}" style="width: 500px;margin-right:15px"
                                                   readonly="#{myprocess_item.currentStepAccessCondition == 'READ'}">
                                                    <f:selectItems value="#{myprocess_item.possibleValues}" var="myprocess_items"
                                                        itemLabel="#{myprocess_items}" itemValue="#{myprocess_items}" />
                                                </h:selectOneMenu>
                                            </h:panelGroup>
                                            <!--  SelectManyMenu -->
                                            <h:panelGroup rendered="#{(myprocess_item.type.name == 'listmultiselect')}">
                                                <h:selectManyListbox style="width: 500px;margin-right:15px"
                                                    value="#{myprocess_item.valueList}" size="5"
                                                    readonly="#{myprocess_item.currentStepAccessCondition == 'READ'}">
                                                    <f:selectItems value="#{myprocess_item.possibleValues}" var="myprocess_items"
                                                        itemLabel="#{myprocess_items}" itemValue="#{myprocess_items}" />
                                                </h:selectManyListbox>
                                            </h:panelGroup>
                                            <!--  Boolean -->
                                            <h:panelGroup rendered="#{(myprocess_item.type.name == 'boolean')}">
                                                <h:selectBooleanCheckbox value="#{myprocess_item.booleanValue}"
                                                    readonly="#{myprocess_item.currentStepAccessCondition == 'READ'}" />
                                            </h:panelGroup>
                                            <!--  Date -->
                                            <h:panelGroup rendered="#{(myprocess_item.type.name == 'date')}">
                                                <x:inputCalendar value="#{myprocess_item.dateValue}" style="width:110px"
                                                    renderAsPopup="true" renderPopupButtonAsImage="true" popupTodayString="#{msgs.heute}"
                                                    popupWeekString="#{msgs.kw}" styleClass="projekteBearbeiten" imageLocation="images/calendarImages"
                                                    popupButtonImageUrl="images/calendarImages/calendar.gif"
                                                    readonly="#{myprocess_item.currentStepAccessCondition == 'READ'}">
                                                </x:inputCalendar>

                                            </h:panelGroup>

                                        </td>
                                    </tr>
                                </x:dataList>
                            </table>
                        </td>
                    </tr>

                    <tr>
                        <td class="eingabeBoxen_row3" align="left">
                            <h:commandButton value="#{msgs.abbrechen}" action="#{NavigationForm.Reload}" immediate="true">
                                <x:updateActionListener property="#{AktuelleSchritteForm.modusBearbeiten}" value="" />
                            </h:commandButton>
                        </td>
                        <td class="eingabeBoxen_row3" align="right">
                            <!-- 
				<h:commandButton value="#{msgs.loeschen}" action="#{AktuelleSchritteForm.deleteProperty}"
					onclick="if (!confirm('#{msgs.sollDieserEintragWirklichGeloeschtWerden}')) return false">
					<x:updateActionListener property="#{AktuelleSchritteForm.modusBearbeiten}" value="" />
				</h:commandButton>
			-->
                            <h:commandButton value="#{msgs.applyToThisProcess}" action="#{AktuelleSchritteForm.saveCurrentProperty}">

                                <x:updateActionListener property="#{AktuelleSchritteForm.modusBearbeiten}" value="" />
                            </h:commandButton>

                        </td>
                    </tr>
                </table>
            </h:panelGroup>
        </h:form>
    </composite:implementation>

</ui:composition>


