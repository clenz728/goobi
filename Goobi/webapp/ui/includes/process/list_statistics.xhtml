<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:x="http://myfaces.apache.org/tomahawk" xmlns:s="http://myfaces.apache.org/sandbox" >

	<composite:interface>
	</composite:interface>

	<composite:implementation>

		<h:panelGroup rendered="#{ProzessverwaltungForm.statisticsManager != null and ProzessverwaltungForm.showStatistics}">

			<!-- ++++++++++++++++     old jfree-Statistic-Charts   ++++++++++++++++ -->

			<h4 style="margin-top: 20px">
				<h:outputText value="#{msgs.statistischeAuswertung}: " />
				<h:outputText value="#{ProzessverwaltungForm.statisticsManager.statisticMode.title}" />
			</h4>





			<!-- ++++++++++++++++     // old jfree-Statistic-Charts   ++++++++++++++++ -->


			<!-- ++++++++++++++++     Action      ++++++++++++++++ -->
			<h:panelGroup rendered="#{ProzessverwaltungForm.statisticsManager.statisticMode.restrictedDate}">


				<table cellpadding="3" cellspacing="0" width="100%" class="eingabeBoxen">
					<tr>
						<td class="eingabeBoxen_row1">
							<h:outputText value="#{msgs.defineStatisticalQuestion}" />
						</td>
					</tr>
					<tr>
						<td class="eingabeBoxen_row2">
							<h:panelGrid columns="8"
								columnClasses="standardTable_ColumnRight,standardTable_Column,standardTable_ColumnRight,standardTable_Column,standardTable_ColumnRight,standardTable_Column, standardTable_Column">

								<h:outputLabel for="from" value="#{msgs.zeitraum} #{msgs.von}" style="width:150px" />
								<h:panelGroup>
									<x:inputCalendar id="from" style="width:110px" value="#{ProzessverwaltungForm.statisticsManager.sourceDateFrom}" renderAsPopup="true"
										renderPopupButtonAsImage="true" popupTodayString="#{msgs.heute}" popupWeekString="#{msgs.kw}" imageLocation="images/calendarImages"
										popupButtonImageUrl="images/calendarImages/calendar.gif" styleClass="projekteBearbeiten" />
								</h:panelGroup>

								<h:outputLabel for="to" value="#{msgs.to}" />
								<h:panelGroup>
									<x:inputCalendar id="to" style="width:110px" value="#{ProzessverwaltungForm.statisticsManager.sourceDateTo}" renderAsPopup="true"
										renderPopupButtonAsImage="true" popupTodayString="#{msgs.heute}" popupWeekString="#{msgs.kw}" imageLocation="images/calendarImages"
										popupButtonImageUrl="images/calendarImages/calendar.gif" styleClass="projekteBearbeiten" />
								</h:panelGroup>

								<h:outputText style="font-weight:bold" value=" - #{msgs.orLast} - " />

								<h:inputText style="width:130px;text-align:right" required="false"
									value="#{ProzessverwaltungForm.statisticsManager.sourceNumberOfTimeUnitsAsString}" />

								<h:selectOneMenu style="width:130px" value="#{ProzessverwaltungForm.statisticsManager.sourceTimeUnit}" converter="StatisticsTimeUnitConverter">
									<f:selectItems value="#{ProzessverwaltungForm.statisticsManager.allTimeUnits}" var="unit" itemLabel="#{unit.title}" itemValue="#{unit}" />
								</h:selectOneMenu>

								<h:panelGroup style="margin-bottom:0px">
									<h:selectBooleanCheckbox value="#{ProzessverwaltungForm.statisticsManager.showAverage}" title="#{msgs.showAverage}">
									</h:selectBooleanCheckbox>
									<h:outputLabel value="#{msgs.showAverage}" />
								</h:panelGroup>

								<h:outputText value="#{msgs.einheit}" style="width:150px" />

								<h:selectOneMenu style="width:130px" value="#{ProzessverwaltungForm.statisticsManager.targetTimeUnit}" converter="StatisticsTimeUnitConverter">
									<f:selectItems value="#{ProzessverwaltungForm.statisticsManager.allTimeUnits}" var="unit" itemLabel="#{unit.title}" itemValue="#{unit}" />
								</h:selectOneMenu>

								<h:outputText value="#{msgs.anzeige}" />

								<h:selectOneMenu style="width:130px" value="#{ProzessverwaltungForm.statisticsManager.targetCalculationUnit}"
									converter="StatisticsCalculationUnitConverter">
									<f:selectItems value="#{ProzessverwaltungForm.statisticsManager.allCalculationUnits}" var="unit" itemLabel="#{unit.title}"
										itemValue="#{unit}" />
								</h:selectOneMenu>

								<h:outputText value="#{msgs.ausgabe}" />

								<h:selectOneMenu style="width:130px" value="#{ProzessverwaltungForm.statisticsManager.targetResultOutput}"
									converter="StatisticsResultOutputConverter">
									<f:selectItems value="#{ProzessverwaltungForm.statisticsManager.allResultOutputs}" var="out" itemLabel="#{out.title}" itemValue="#{out}" />
								</h:selectOneMenu>

								<h:panelGroup style="margin-bottom:0px">
								</h:panelGroup>

								<h:panelGroup style="margin-bottom:0px" rendered="#{ProzessverwaltungForm.statisticsManager.renderLoopOption}">
									<h:selectBooleanCheckbox value="#{ProzessverwaltungForm.statisticsManager.includeLoops}" title="#{msgs.includeLoops}">
									</h:selectBooleanCheckbox>
									<h:outputLabel value="#{msgs.includeLoops}" />
								</h:panelGroup>

							</h:panelGrid>
							<x:commandButton id="myStatisticButton" forceId="true" style="margin:5px" title="#{msgs.calculateStatistics}"
								value="#{msgs.calculateStatistics}" action="#{ProzessverwaltungForm.statisticsManager.calculate}">
								<x:updateActionListener property="#{ProzessverwaltungForm.showStatistics}" value="true" />
							</x:commandButton>
							<x:message for="myStatisticButton" style="color: red" />
							<br />

						</td>
					</tr>

				</table>
			</h:panelGroup>
			<!-- ++++++++++++++++     // Action      ++++++++++++++++ -->

			<!-- ++++++++++++++++     Presentation of Data      ++++++++++++++++ -->

			<h:panelGroup rendered="#{ProzessverwaltungForm.statisticsManager.statisticMode.isSimple}">
				<img style="margin-bottom: 15px"
					src="#{HelperForm.servletPathWithHostAsUrl}/imagesTemp/#{ProzessverwaltungForm.statisticsManager.jfreeImage}" title="#{element.title}" />
			</h:panelGroup>

			<h:panelGroup rendered="#{!ProzessverwaltungForm.statisticsManager.statisticMode.isSimple}">


				<x:dataList var="element" rendered="#{ProzessverwaltungForm.statisticsManager.renderingElements!=null}"
					value="#{ProzessverwaltungForm.statisticsManager.renderingElements}" layout="ordered list" rowCountVar="rowCount" rowIndexVar="rowIndex">

					<h:panelGroup rendered="#{element.dataTable.showableInChart and ProzessverwaltungForm.statisticsManager.targetResultOutput=='chart'}">
						<h4 style="margin-top: 20px">
							<h:outputText value="#{element.title}" />
						</h4>
						<img style="margin-bottom: 15px" src="#{HelperForm.servletPathWithHostAsUrl}/imagesTemp/#{element.imageUrl}" title="#{element.title}" />
					</h:panelGroup>


					<h:panelGroup rendered="#{element.dataTable.showableInTable and ProzessverwaltungForm.statisticsManager.targetResultOutput== 'table'}">
						<h4 style="margin-top: 20px">
							<h:outputText value="#{element.title}" />
						</h4>
						<h:outputText value="#{element.htmlTableRenderer.rendering}" escape="false" />
						<h:commandLink action="#{ProzessverwaltungForm.CreateExcel}" title="#{msgs.createExcel}">
							<h:graphicImage value="images/buttons/excel20.png" />
							<h:outputText value="  #{msgs.createExcel}" />
							<x:updateActionListener value="#{element}" property="#{ProzessverwaltungForm.myCurrentTable}" />
						</h:commandLink>
					</h:panelGroup>

					<h:panelGroup rendered="#{ProzessverwaltungForm.statisticsManager.targetResultOutput=='chartAndTable'}">
						<h4 style="margin-top: 20px">
							<h:outputText value="#{element.title}" />
						</h4>
						<h:panelGroup>
							<h:panelGroup rendered="#{element.dataTable.showableInChart}">
								<img style="margin-bottom: 15px" src="#{HelperForm.servletPathWithHostAsUrl}/imagesTemp/#{element.imageUrl}" title="#{element.title}" />
							</h:panelGroup>
							<h:outputText value="#{element.htmlTableRenderer.rendering}" escape="false" rendered="#{element.dataTable.showableInTable}" />
							<h:commandLink action="#{ProzessverwaltungForm.CreateExcel}" title="#{msgs.createExcel}" rendered="#{element.dataTable.showableInTable}">
								<h:graphicImage value="images/buttons/excel20.png" />
								<h:outputText value="  #{msgs.createExcel}" />
								<x:updateActionListener value="#{element}" property="#{ProzessverwaltungForm.myCurrentTable}" />
							</h:commandLink>
						</h:panelGroup>
					</h:panelGroup>
				</x:dataList>





			</h:panelGroup>

			<!-- ++++++++++++++++     // Presentation of Data      ++++++++++++++++ -->

			<!-- hide statistics, if any action happens
for old simple statistics: hide immediatly
for the new enhanced statistics: hide it only, when some data where calculated




<h:outputText value="#{ProzessverwaltungForm.resetStatistic}"
    rendered="#{ProzessverwaltungForm.statisticsManager != null and (ProzessverwaltungForm.statisticsManager.statisticMode.isSimple or (!ProzessverwaltungForm.statisticsManager.statisticMode.isSimple and ProzessverwaltungForm.statisticsManager.myDataTables!=null))}" />
    -->

		</h:panelGroup>

		<h:outputText value="#{ProzessverwaltungForm.resetStatistic}" rendered="#{ProzessverwaltungForm.statisticsManager.statisticMode.isSimple}" />


	</composite:implementation>

</ui:composition>


