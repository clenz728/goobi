<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" template="/ui/template/template.html" xmlns:x="http://myfaces.apache.org/tomahawk">

    <ui:define name="breadcrumb">
        <h:commandLink id="id2" value="#{msgs.startseite}" action="index" />
        <f:verbatim> &#8250;&#8250; </f:verbatim>
        <h:outputText value="#{msgs.nachEinemBandSuchen}" />
    </ui:define>

    <ui:define name="title">
        <h:outputText value="#{msgs.nachEinemBandSuchen}" />
    </ui:define>

    <ui:define name="content">

        <h:form id="searchform" onkeypress="ifEnterClick(event, 'absenden');" prependId="false">

            <table cellpadding="3" cellspacing="0" width="100%" class="eingabeBoxen">

                <tr>
                    <td class="eingabeBoxen_row1" colspan="2">
                        <h:outputText value="#{msgs.suche}" />
                    </td>
                </tr>

                <tr>
                    <td class="eingabeBoxen_row2" colspan="2">

                        <h:dataTable value="#{SearchForm.rowList}" var="row" class="eingabeBoxen_row2" id="rowList" width="100%" columnClasses="column1, column2, column3, column4">

                            <h:column>
                                <h:selectOneMenu value="#{row.fieldName}" style="width: 100%">
                                    <f:selectItems var="fieldname" value="#{SearchForm.fieldnameList}" itemValue="#{fieldname.value}" itemLabel="#{msgs[fieldname.label]}" />
                                    <f:ajax render="@form" execute="@form" />
                                </h:selectOneMenu>
                            </h:column>

                            <h:column>

                                <h:panelGroup rendered="#{row.fieldName != 'PROCESSID'}">
                                    <h:selectOneMenu value="#{row.fieldOperand}" style="width: 100%">
                                        <f:selectItems value="#{SearchForm.operands}" />
                                    </h:selectOneMenu>
                                </h:panelGroup>

                                <h:panelGroup rendered="#{row.fieldName == 'PROCESSID'}">
                                    <h:selectOneMenu value="#{row.fieldOperand}" style="width: 100%">
                                        <f:selectItems value="#{SearchForm.operandsForID}" />
                                    </h:selectOneMenu>
                                </h:panelGroup>


                            </h:column>

                            <h:column>

                                <h:inputText value="#{row.fieldValue}" style="width:99%" rendered="#{row.fieldName == 'PROCESSID' or row.fieldName == 'PROCESSTITLE' or row.fieldName == 'BATCH' or row.fieldName == 'PROCESSLOG'}">
                                    <f:ajax render="@form" execute="@form" />
                                </h:inputText>

                                <h:panelGroup rendered="#{row.fieldName == 'STEP'}" layout="block" style="width:100%">
                                    <h:selectOneMenu value="#{row.stepStatus}" style="width:30%">
                                        <f:selectItems value="#{SearchForm.stepstatus}" var="stepstatus" itemLabel="#{stepstatus.title}" itemValue="#{stepstatus.searchString}" />
                                        <f:ajax render="@form" execute="@form" />
                                    </h:selectOneMenu>
                                    <h:selectOneMenu value="#{row.stepName}" style="width:69%; float:right">
                                        <f:selectItems value="#{SearchForm.stepTitles}" var="stepTitles" itemLabel="#{stepTitles}" itemValue="#{stepTitles}" />
                                    </h:selectOneMenu>
                                </h:panelGroup>


                                <h:selectOneMenu value="#{row.projectName}" rendered="#{row.fieldName == 'PROJECT'}" style="width:100%">
                                    <f:selectItems value="#{SearchForm.projects}" var="proj" itemLabel="#{proj}" itemValue="#{proj}" />
                                    <f:ajax render="@form" execute="@form" />
                                </h:selectOneMenu>

                                <h:panelGroup rendered="#{row.fieldName == 'PROCESSPROPERTY'}" layout="block" style="width:100%">
                                    <h:selectOneMenu value="#{row.processPropertyName}" style="width: 30%">
                                        <f:selectItems value="#{SearchForm.processPropertyTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                                        <f:ajax render="@form" execute="@form" />
                                    </h:selectOneMenu>
                                    <h:inputText value="#{row.processPropertyValue}" style="width: 68%; float:right">

                                    </h:inputText>
                                </h:panelGroup>

                                <h:panelGroup rendered="#{row.fieldName == 'TEMPLATE'}" layout="block" style="width:100%">
                                    <h:selectOneMenu value="#{row.templatePropertyName}" style="width: 30%">
                                        <f:selectItems value="#{SearchForm.templatePropertyTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                                        <f:ajax render="@form" execute="@form" />
                                    </h:selectOneMenu>
                                    <h:inputText value="#{row.templatePropertyValue}" style="width: 68%; float:right">
                                    </h:inputText>
                                </h:panelGroup>

                                <h:panelGroup rendered="#{row.fieldName == 'WORKPIECE'}" layout="block" style="width:100%">
                                    <h:selectOneMenu value="#{row.masterpiecePropertyName}" style="width: 30%">
                                        <f:selectItems value="#{SearchForm.masterpiecePropertyTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                                        <f:ajax render="@form" execute="@form" />
                                    </h:selectOneMenu>
                                    <h:inputText value="#{row.masterpiecePropertyValue}" style="width: 68%; float:right">
                                    </h:inputText>

                                </h:panelGroup>

                                <h:panelGroup rendered="#{row.fieldName == 'METADATA'}" layout="block" style="width:100%">
                                    <h:selectOneMenu value="#{row.metadataName}" style="width: 30%">
                                        <f:selectItems value="#{SearchForm.metadataTitles}" var="proc" itemLabel="#{msgs[proc]}" itemValue="#{proc}" />
                                        <f:ajax render="@form" execute="@form" />
                                    </h:selectOneMenu>
                                    <h:inputText value="#{row.metadataValue}" style="width: 68%; float:right">
                                    </h:inputText>
                                </h:panelGroup>

                            </h:column>

                            <h:column>
                                <h:commandLink action="#{SearchForm.addRow}">
                                    <h:graphicImage value="images/plus.gif" style="margin-right:4px" />
                                </h:commandLink>

                                <h:commandLink action="#{SearchForm.deleteRow}" rendered="#{SearchForm.sizeOfRowList > 1}">
                                    <h:graphicImage value="images/minus.gif" style="margin-right:4px" />
                                    <x:updateActionListener property="#{SearchForm.currentRow}" value="#{row}" />
                                </h:commandLink>
                            </h:column>


                        </h:dataTable>
                        <h:panelGrid columns="2" rendered="#{(LoginForm.maximaleBerechtigung == 1)}" columnClasses="prozessKopieSpalte1, prozessKopieSpalte2">

                            <h:outputText value="#{msgs.showArchivedProjects}:" />
                            <h:selectBooleanCheckbox value="#{ProzessverwaltungForm.showArchivedProjects}">
                                <f:ajax render="@form" execute="@form" />
                            </h:selectBooleanCheckbox>
                        </h:panelGrid>

                        <h:panelGrid columns="2" columnClasses="prozessKopieSpalte1, prozessKopieSpalte2">
                            <h:outputText value="#{msgs.showClosedProcesses}:" />
                            <h:selectBooleanCheckbox value="#{ProzessverwaltungForm.showClosedProcesses}">
                                <f:ajax render="@form" execute="@form" />
                            </h:selectBooleanCheckbox>
                        </h:panelGrid>
                    </td>
                </tr>
                <tr>
                    <td class="eingabeBoxen_row3" align="left">
                        <h:commandButton value="#{msgs.clear}" action="#{SearchForm.resetFilter}" immediate="true">
                        </h:commandButton>
                    </td>

                    <td class="eingabeBoxen_row3" align="right">
                        <h:commandButton id="absenden" action="#{SearchForm.createFilter}" title="#{msgs.filterAnwenden}" value="#{msgs.filterAnwenden}" onclick="jQuery('#ajaxloader').show();">
                        </h:commandButton>
                    </td>
                </tr>
            </table>
        </h:form>

    </ui:define>

</ui:composition>
