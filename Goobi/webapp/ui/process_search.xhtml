<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core" template="/ui/template/template.html" xmlns:x="http://myfaces.apache.org/tomahawk">

    <ui:define name="breadcrumb">
        <h:commandLink id="id2" value="#{msgs.startseite}" action="index" />
        <f:verbatim> &#8250;&#8250; </f:verbatim>
        <h:outputText value="#{msgs.nachEinemBandSuchen}" />
    </ui:define>

    <ui:define name="title">
        <h:outputText value="#{msgs.nachEinemBandSuchen}" />
    </ui:define>

    <ui:define name="content">

        <h:form id="searchform" onkeypress="ifEnterClick(event, 'searchform:absenden');">

            <table cellpadding="3" cellspacing="0" width="100%" class="eingabeBoxen">

                <tr>
                    <td class="eingabeBoxen_row1" colspan="2">
                        <h:outputText value="#{msgs.suche}" />
                    </td>
                </tr>

                <tr>
                    <td class="eingabeBoxen_row2" colspan="2">
                        <h:panelGrid id="extended" columns="2" rendered="#{ProzessverwaltungForm.initialize}">

                            <!-- process title -->
                            <h:outputText value="#{msgs.title}: " />
                            <h:panelGroup>
                                <h:selectOneMenu value="#{SearchForm.processOperand}" style="width:115px; margin-right:3px">
                                    <f:selectItems value="#{SearchForm.operands}" />
                                </h:selectOneMenu>
                                <h:inputText value="#{SearchForm.processTitle}" style="width:570px" />

                            </h:panelGroup>

                            <!--projects -->
                            <h:outputText value="#{msgs.projects}: " />
                            <h:panelGroup>
                                <h:selectOneMenu value="#{SearchForm.projectOperand}" style="width:115px; margin-right:3px">
                                    <f:selectItems value="#{SearchForm.operands}" />
                                </h:selectOneMenu>

                                <h:selectOneMenu value="#{SearchForm.project}" style="width:570px">
                                    <f:selectItems id="pcid11" value="#{SearchForm.projects}" var="proj" itemLabel="#{proj}" itemValue="#{proj}" />
                                </h:selectOneMenu>
                            </h:panelGroup>


                            <!-- process property -->
                            <h:outputText value="#{msgs.processProperties}: " />
                            <h:panelGroup>
                                <h:selectOneMenu value="#{SearchForm.processPropertyOperand}" style="width:115px; margin-right:3px">
                                    <f:selectItems value="#{SearchForm.operands}" />
                                </h:selectOneMenu>
                                <h:panelGroup>
                                    <h:selectOneMenu value="#{SearchForm.processPropertyTitle}" style="width:175px; margin-right:3px">
                                        <f:selectItems value="#{SearchForm.processPropertyTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                                    </h:selectOneMenu>
                                    <h:inputText value="#{SearchForm.processPropertyValue}" style="width:394px" />
                                </h:panelGroup>
                            </h:panelGroup>

                            <!-- metadata -->
                            <h:outputText value="#{msgs.metadata}: " />
                            <h:panelGroup>
                                <h:selectOneMenu value="#{SearchForm.metadataOperand}" style="width:115px; margin-right:3px">
                                    <f:selectItems value="#{SearchForm.operands}" />
                                </h:selectOneMenu>
                                <h:panelGroup>
                                    <h:selectOneMenu value="#{SearchForm.metadataTitle}" style="width:175px; margin-right:3px">
                                        <f:selectItems value="#{SearchForm.metadataTitles}" var="meta" itemLabel="#{msgs[meta]}" itemValue="#{meta}" />
                                    </h:selectOneMenu>
                                    <h:inputText value="#{SearchForm.metadataValue}" style="width:394px" />
                                </h:panelGroup>
                            </h:panelGroup>

                            <!-- masterpiece property -->
                            <h:outputText value="#{msgs.masterpieceProperties}: " />
                            <h:panelGroup>
                                <h:selectOneMenu value="#{SearchForm.masterpiecePropertyOperand}" style="width:115px; margin-right:3px">
                                    <f:selectItems value="#{SearchForm.operands}" />
                                </h:selectOneMenu>
                                <h:panelGroup>
                                    <h:selectOneMenu value="#{SearchForm.masterpiecePropertyTitle}" style="width:175px; margin-right:3px">
                                        <f:selectItems value="#{SearchForm.masterpiecePropertyTitles}" var="work" itemLabel="#{work}"
                                            itemValue="#{work}" />
                                    </h:selectOneMenu>
                                    <h:inputText value="#{SearchForm.masterpiecePropertyValue}" style="width:394px" />
                                </h:panelGroup>
                            </h:panelGroup>
                            <!-- template property -->
                            <h:outputText value="#{msgs.templateProperties}: " />
                            <h:panelGroup>
                                <h:selectOneMenu value="#{SearchForm.templatePropertyOperand}" style="width:115px; margin-right:3px">
                                    <f:selectItems value="#{SearchForm.operands}" />
                                </h:selectOneMenu>
                                <h:panelGroup>
                                    <h:selectOneMenu value="#{SearchForm.templatePropertyTitle}" style="width:175px; margin-right:3px">
                                        <f:selectItems value="#{SearchForm.templatePropertyTitles}" var="temp" itemLabel="#{temp}" itemValue="#{temp}" />
                                    </h:selectOneMenu>
                                    <h:inputText value="#{SearchForm.templatePropertyValue}" style="width:394px" />
                                </h:panelGroup>
                            </h:panelGroup>
                            <!-- step property -->
                            <h:outputText value="#{msgs.stepProperties}: " />
                            <h:panelGroup>
                                <h:selectOneMenu value="#{SearchForm.stepPropertyOperand}" style="width:115px; margin-right:3px">
                                    <f:selectItems value="#{SearchForm.operands}" />
                                </h:selectOneMenu>
                                <h:panelGroup>
                                    <h:selectOneMenu value="#{SearchForm.stepPropertyTitle}" style="width:175px; margin-right:3px">
                                        <f:selectItems value="#{SearchForm.stepPropertyTitles}" var="step" itemLabel="#{step}" itemValue="#{step}" />
                                    </h:selectOneMenu>
                                    <h:inputText value="#{SearchForm.stepPropertyValue}" style="width:394px" />
                                </h:panelGroup>
                            </h:panelGroup>
                            <!--steps -->
                            <h:outputText value="#{msgs.step}: " />
                            <h:panelGroup>
                                <h:selectOneMenu value="#{SearchForm.stepOperand}" style="width:115px; margin-right:3px">
                                    <f:selectItems value="#{SearchForm.operands}" />
                                </h:selectOneMenu>
                                <h:panelGroup>
                                    <h:selectOneMenu value="#{SearchForm.status}" style="width:175px; margin-right:3px">
                                        <f:selectItems value="#{SearchForm.stepstatus}" var="stepstatus" itemLabel="#{stepstatus.title}"
                                            itemValue="#{stepstatus.searchString}" />
                                    </h:selectOneMenu>
                                    <h:selectOneMenu value="#{SearchForm.stepname}" style="width:394px">
                                        <f:selectItems value="#{SearchForm.stepTitles}" var="stepTitles" itemLabel="#{stepTitles}"
                                            itemValue="#{stepTitles}" />
                                    </h:selectOneMenu>
                                </h:panelGroup>
                            </h:panelGroup>
                            <!-- user -->
                            <!-- 
							<h:outputText value="#{msgs.user}: " />
							<h:panelGroup>
								<h:selectOneMenu value="#{SearchForm.stepdoneuser}">
									<si:selectItems value="#{SearchForm.user}" var="user"
										itemLabel="#{user.nachVorname}" itemValue="#{user.login}" />
								</h:selectOneMenu>
								<h:selectOneMenu value="#{SearchForm.stepdonetitle}">
									<si:selectItems value="#{SearchForm.stepTitles}"
										var="stepTitles" itemLabel="#{stepTitles}"
										itemValue="#{stepTitles}" />
								</h:selectOneMenu>
							</h:panelGroup>
							-->
                            <!-- process id -->
                            <h:outputText value="#{msgs.id}: " />
                            <h:inputText value="#{SearchForm.idin}" style="width:690px" />

                            <!-- batch id -->
                            <h:outputText value="#{msgs.batch}: " />
                            <h:inputText value="#{SearchForm.batchid}" style="width:690px" />


                            <h:outputText value="#{msgs.showArchivedProjects}:" rendered="#{(LoginForm.maximaleBerechtigung == 1)}" />
                            <h:selectBooleanCheckbox value="#{ProzessverwaltungForm.showArchivedProjects}"
                                rendered="#{(LoginForm.maximaleBerechtigung == 1)}" />

                            <h:outputText value="#{msgs.showClosedProcesses}:" />
                            <h:selectBooleanCheckbox value="#{ProzessverwaltungForm.showClosedProcesses}" />

                        </h:panelGrid>
                    </td>
                </tr>
                <tr>
                    <td class="eingabeBoxen_row3" align="left">
                        <h:commandButton value="#{msgs.clear}" action="process_search" immediate="true">
                        </h:commandButton>
                    </td>

                    <td class="eingabeBoxen_row3" align="right">
                        <h:commandButton id="absenden" action="#{SearchForm.filter}" title="#{msgs.filterAnwenden}" value="#{msgs.filterAnwenden}">
                        </h:commandButton>
                    </td>
                </tr>
            </table>
        </h:form>

        <h:form>
            <h:dataTable value="#{SearchForm.rowList}" var="row">
                <h:column>

                    <h:selectOneMenu value="#{row.firstFieldName}">
                        <f:selectItems var="fieldname" value="#{SearchForm.fieldnameList}" itemValue="#{fieldname.value}"
                            itemLabel="#{msgs[fieldname.label]}" />
                        <f:ajax render="@form" />
                    </h:selectOneMenu>
                </h:column>

                <h:column>
                    <h:selectOneMenu value="#{row.firstFieldOperand}">
                        <f:selectItem itemLabel="enthält" itemValue=" IS " />
                        <f:selectItem itemLabel="enthält nicht" itemValue=" IS NOT " />
                    </h:selectOneMenu>

                </h:column>

                <h:column>
                    <h:inputText value="#{row.firstFieldValue}"
                        rendered="#{row.firstFieldName == 'PROCESSID' or row.firstFieldName == 'PROCESSTITLE' or row.firstFieldName == 'BATCH'}">
                        <f:ajax render="@form" />
                    </h:inputText>

                    <h:panelGroup rendered="#{row.firstFieldName == 'STEP'}" layout="block">
                        <h:selectOneMenu value="#{SearchForm.status}">
                            <f:selectItems value="#{SearchForm.stepstatus}" var="stepstatus" itemLabel="#{stepstatus.title}"
                                itemValue="#{stepstatus.searchString}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{SearchForm.stepname}">
                            <f:selectItems value="#{SearchForm.stepTitles}" var="stepTitles" itemLabel="#{stepTitles}" itemValue="#{stepTitles}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                    </h:panelGroup>


                    <h:selectOneMenu value="#{row.firstProjectName}" rendered="#{row.firstFieldName == 'PROJECT'}">
                        <f:selectItems value="#{SearchForm.projects}" var="proj" itemLabel="#{proj}" itemValue="#{proj}" />
                        <f:ajax render="@form" />
                    </h:selectOneMenu>

                    <h:panelGroup rendered="#{row.firstFieldName == 'PROCESSPROPERTY'}" layout="block">
                        <h:selectOneMenu value="#{row.firstProcessPropertyName}">
                            <f:selectItems value="#{SearchForm.processPropertyTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                        <h:inputText value="#{row.firstProcessPropertyValue}">
                            <f:ajax render="@form" />
                        </h:inputText>
                    </h:panelGroup>

                    <h:panelGroup rendered="#{row.firstFieldName == 'TEMPLATE'}" layout="block">
                        <h:selectOneMenu value="#{row.firstTemplatePropertyName}">
                            <f:selectItems value="#{SearchForm.templatePropertyTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                        <h:inputText value="#{row.firstTemplatePropertyValue}">
                            <f:ajax render="@form" />
                        </h:inputText>
                    </h:panelGroup>

                    <h:panelGroup rendered="#{row.firstFieldName == 'WORKPIECE'}" layout="block">
                        <h:selectOneMenu value="#{row.firstMasterpiecePropertyName}">
                            <f:selectItems value="#{SearchForm.masterpiecePropertyTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                        <h:inputText value="#{row.firstMasterpiecePropertyValue}">
                            <f:ajax render="@form" />
                        </h:inputText>

                    </h:panelGroup>

                    <h:panelGroup rendered="#{row.firstFieldName == 'METADATA'}" layout="block">
                        <h:selectOneMenu value="#{row.firstMetadataName}">
                            <f:selectItems value="#{SearchForm.metadataTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                        <h:inputText value="#{row.firstMetadataValue}">
                            <f:ajax render="@form" />
                        </h:inputText>
                    </h:panelGroup>

                </h:column>



                <h:column>
                    <h:selectOneMenu value="#{row.fieldOperand}">
                        <f:selectItem itemLabel="und" itemValue=" AND " />
                        <f:selectItem itemLabel="oder" itemValue=" OR " />
                    </h:selectOneMenu>
                </h:column>


                <h:column>

                    <h:selectOneMenu value="#{row.secondFieldName}">
                        <f:selectItems var="fieldname" value="#{SearchForm.fieldnameList}" itemValue="#{fieldname.value}"
                            itemLabel="#{fieldname.label}" />
                        <f:ajax render="@form" />
                    </h:selectOneMenu>
                </h:column>

                <h:column>
                    <h:selectOneMenu value="#{row.secondFieldOperand}">
                        <f:selectItem itemLabel="enthält" itemValue=" IS " />
                        <f:selectItem itemLabel="enthält nicht" itemValue=" IS NOT " />
                    </h:selectOneMenu>

                </h:column>

                <h:column>
                    <h:inputText value="#{row.secondFieldValue}"
                        rendered="#{row.secondFieldName == 'PROCESSID' or row.secondFieldName == 'PROCESSTITLE' or row.secondFieldName == 'BATCH'}">
                        <f:ajax render="@form" />
                    </h:inputText>

                    <h:panelGroup rendered="#{row.secondFieldName == 'STEP'}" layout="block">
                        <h:selectOneMenu value="#{SearchForm.status}">
                            <f:selectItems value="#{SearchForm.stepstatus}" var="stepstatus" itemLabel="#{stepstatus.title}"
                                itemValue="#{stepstatus.searchString}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                        <h:selectOneMenu value="#{SearchForm.stepname}">
                            <f:selectItems value="#{SearchForm.stepTitles}" var="stepTitles" itemLabel="#{stepTitles}" itemValue="#{stepTitles}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                    </h:panelGroup>


                    <h:selectOneMenu value="#{row.secondProjectName}" rendered="#{row.secondFieldName == 'PROJECT'}">
                        <f:selectItems value="#{SearchForm.projects}" var="proj" itemLabel="#{proj}" itemValue="#{proj}" />
                        <f:ajax render="@form" />
                    </h:selectOneMenu>

                    <h:panelGroup rendered="#{row.secondFieldName == 'PROCESSPROPERTY'}" layout="block">
                        <h:selectOneMenu value="#{row.secondProcessPropertyName}">
                            <f:selectItems value="#{SearchForm.processPropertyTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                        <h:inputText value="#{row.secondProcessPropertyValue}">
                            <f:ajax render="@form" />
                        </h:inputText>
                    </h:panelGroup>

                    <h:panelGroup rendered="#{row.secondFieldName == 'TEMPLATE'}" layout="block">
                        <h:selectOneMenu value="#{row.secondTemplatePropertyName}">
                            <f:selectItems value="#{SearchForm.templatePropertyTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                        <h:inputText value="#{row.secondTemplatePropertyValue}">
                            <f:ajax render="@form" />
                        </h:inputText>
                    </h:panelGroup>

                    <h:panelGroup rendered="#{row.secondFieldName == 'WORKPIECE'}" layout="block">
                        <h:selectOneMenu value="#{row.secondMasterpiecePropertyName}">
                            <f:selectItems value="#{SearchForm.masterpiecePropertyTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                        <h:inputText value="#{row.secondMasterpiecePropertyValue}">
                            <f:ajax render="@form" />
                        </h:inputText>
                    </h:panelGroup>


                    <h:panelGroup rendered="#{row.secondFieldName == 'METADATA'}" layout="block">
                        <h:selectOneMenu value="#{row.secondMetadataName}">
                            <f:selectItems value="#{SearchForm.metadataTitles}" var="proc" itemLabel="#{proc}" itemValue="#{proc}" />
                            <f:ajax render="@form" />
                        </h:selectOneMenu>
                        <h:inputText value="#{row.secondMetadataValue}">
                            <f:ajax render="@form" />
                        </h:inputText>
                    </h:panelGroup>

                </h:column>


                <h:column>
                    <h:commandLink action="#{SearchForm.addRow}">
                        <h:graphicImage value="images/plus.gif" style="margin-right:4px" />
                    </h:commandLink>

                    <h:commandLink action="#{SearchForm.deleteRow}" rendered="#{SearchForm.sizeOfRowList > 1}">
                        <h:graphicImage value="images/minus.gif" style="margin-right:4px" />
                        <x:updateActionListener property="#{SearchForm.currentRow}" value="#{row}" />
                    </h:commandLink>

                </h:column>


            </h:dataTable>

            <h:outputText value="#{msgs.showArchivedProjects}:" rendered="#{(LoginForm.maximaleBerechtigung == 1)}" />
            <h:selectBooleanCheckbox value="#{ProzessverwaltungForm.showArchivedProjects}" rendered="#{(LoginForm.maximaleBerechtigung == 1)}" />

            <h:outputText value="#{msgs.showClosedProcesses}:" />
            <h:selectBooleanCheckbox value="#{ProzessverwaltungForm.showClosedProcesses}" />

            <h:commandButton id="absenden" action="#{SearchForm.createFilter}" title="#{msgs.filterAnwenden}" value="#{msgs.filterAnwenden}">
            </h:commandButton>

        </h:form>

    </ui:define>

</ui:composition>
