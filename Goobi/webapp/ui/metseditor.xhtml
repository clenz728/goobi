<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core" template="/ui/template/template_metadata.html" xmlns:x="http://myfaces.apache.org/tomahawk" xmlns:p="http://primefaces.org/ui">

    <ui:define name="top_title">
        <h:outputText style="font-size:17px; font-family:verdana; color: white;" value="#{Metadaten.myProzess.titel}" />
    </ui:define>

    <ui:define name="top_individual">
        <ui:include src="includes/metseditor/metseditor_top.xhtml" />
    </ui:define>

    <ui:define name="sidebar_top">
        <ui:include src="includes/metseditor/metseditor_left.xhtml" />
    </ui:define>

    <ui:define name="breadcrumb">

        <table id="bla" width="100%" cellspacing="0" cellpadding="0">
            <tr>
                <td>
                    <h:panelGroup id="vdid3" rendered="#{not Metadaten.nurLesenModus}">

                        <h:commandLink id="vdid4" action="#{Metadaten.AnsichtAendern}" value="#{msgs.paginierung}" style="font-size: 11px;"
                            rendered="#{Metadaten.modusAnsicht != 'Paginierung'}">
                            <f:param id="vdid5" name="Ansicht" value="Paginierung" />
                             
                        </h:commandLink>
                        <h:outputText id="vdid6" value="#{msgs.paginierung}" style="font-weight:bold;font-size: 11px"
                            rendered="#{Metadaten.modusAnsicht == 'Paginierung'}" />
                        <h:outputText id="vdid7" value=" | " style="font-size: 11px;" />

                        <h:commandLink id="vdid8" action="#{Metadaten.AnsichtAendern}" value="#{msgs.strukturdaten}" style="font-size: 11px;"
                            rendered="#{Metadaten.modusAnsicht != 'Strukturdaten'}">
                            <f:param id="vdid9" name="Ansicht" value="Strukturdaten" />
                           
                        </h:commandLink>

                        <h:outputText id="vdid10" value="#{msgs.strukturdaten}" style="font-weight:bold;font-size: 11px;"
                            rendered="#{Metadaten.modusAnsicht == 'Strukturdaten'}" />
                        <h:outputText id="vdid11" value=" | " style="font-size: 11px;" />

                        <h:commandLink id="vdid12" action="#{Metadaten.AnsichtAendern}" value="#{msgs.metadaten}" style="font-size: 11px;"
                            rendered="#{Metadaten.modusAnsicht != 'Metadaten'}">
                            <f:param id="vdid13" name="Ansicht" value="Metadaten" />
                           
                        </h:commandLink>

                        <h:outputText id="vdid14" value="#{msgs.metadaten}" style="font-weight:bold;font-size: 11px;"
                            rendered="#{Metadaten.modusAnsicht == 'Metadaten'}" />

                        <h:outputText id="vdid15" value=" | " style="font-size: 11px;" rendered="#{Metadaten.displayFileManipulation}" />

                        <h:commandLink id="vdid16" action="#{Metadaten.AnsichtAendern}" value="#{msgs.fileManipulation}" style="font-size: 11px;"
                            rendered="#{Metadaten.modusAnsicht != 'File' and Metadaten.displayFileManipulation}">
                            <f:param id="vdid17" name="Ansicht" value="File" />
                           
                        </h:commandLink>

                        <h:outputText id="vdid18" value="#{msgs.fileManipulation}" style="font-weight:bold;font-size: 11px;"
                            rendered="#{Metadaten.modusAnsicht == 'File' and Metadaten.displayFileManipulation}" />

                    </h:panelGroup>
                </td>

                <td align="right">
                    <h:commandLink action="#{Metadaten.BildAnzeigen}" rendered="#{Metadaten.bildAnzeigen==true}"
                        value="#{msgs.metadatenBildAusblenden}" style="#{Metadaten.nurLesenModus ? 'font-size:11px':'font-size:11px;'}" >
                       	<f:ajax render="@form :metadatenRechtsWrapp" />
                    </h:commandLink>
                    <h:commandLink action="#{Metadaten.BildAnzeigen}" rendered="#{Metadaten.bildAnzeigen==false}"
                        value="#{msgs.metadatenBildAnzeigen}" style="#{Metadaten.nurLesenModus ? 'font-size:11px':'font-size:11px;'}">
                        <f:ajax render="@form :metadatenRechtsWrapp" />
                    </h:commandLink>
                        
                    <h:outputText value=" | " style="font-size: 11px;" />
                    <!-- Metadaten validieren -->
                    <h:commandLink style="font-size:11px" action="#{Metadaten.Validate}" value="#{msgs.validieren}"
                        rendered="#{not Metadaten.nurLesenModus}" >
<!--                         <f:ajax render="@form :metadatenRechtsWrapp" /> -->
                    </h:commandLink>
                    <h:outputText value=" | " style="font-size: 11px;" rendered="#{not Metadaten.nurLesenModus}" />
                    <!-- Metadaten nicht schreiben, nur zurück gehen-->
                    <h:commandLink style="font-size:11px" action="#{Metadaten.goZurueck}" value="#{msgs.goBack}" target="_parent" immediate="true"
                        id="returnButton" />
                    <h:outputText value=" | " style="font-size: 11px;" rendered="#{not Metadaten.nurLesenModus}" />
                    <!-- Metadaten schreiben -->
                    <h:commandLink style="font-size:11px" action="#{Metadaten.Reload}" value="#{msgs.speichern}"
                        rendered="#{not Metadaten.nurLesenModus}" immediate="false" />
                    <h:outputText value=" | " style="font-size: 11px;" rendered="#{not Metadaten.nurLesenModus}" />
                    <!-- Metadaten schreiben und zurück gehen-->
                    <h:commandLink style="font-size:11px" target="_parent" action="#{Metadaten.XMLschreiben}" value="#{msgs.speichernZurueck}"
                        rendered="#{not Metadaten.nurLesenModus}" immediate="false" onclick="displayProgressBar()" />
                </td>
            </tr>
        </table>
    </ui:define>

    <ui:define name="content">

        <h:form id="progressform" prependId="false">
            <h:panelGroup style="display: none" id="progressPanel">
                <p:commandButton value="Start" onclick="PF('pbAjax').start();" type="button" widgetVar="startButton2" id="progressbutton"
                    style="display: none;" />

                <p:progressBar widgetVar="pbAjax" ajax="true" value="#{Metadaten.progress}" labelTemplate="{value}%" styleClass="animated"
                    global="false" style="margin: 5px 0px 5px 0px">
                    <p:ajax event="complete" listener="#{Metadaten.onComplete}" />
                </p:progressBar>

            </h:panelGroup>
            <script type="text/javascript">
                                        function displayProgressBar() {
                                                    var element = document.getElementById('progressPanel');
                                                    if (element.style.display == 'block') {
                                                        element.style.display = 'none';
                                                    } else {
                                                        element.style.display = 'block';
                                                    }
                                                    document.getElementById('progressbutton').click();
                                                }

                                                function start() {

                                                    window['progress'] = setInterval(
                                                            function() {
                                                                var pbClient = PF('pbClient'), oldValue = pbClient.getValue(), newValue = oldValue + 10;

                                                                pbClient.setValue(pbClient.getValue() + 10);

                                                                if (newValue === 100) {
                                                                    clearInterval(window['progress']);
                                                                    
                                                                }
                                                            },
                                                            1000);
                                                }
             </script>
        </h:form>
        <h:panelGroup id="metadatenRechtsWrapp" >
            <table id="metadatenRechts" cellpadding="2" cellspacing="0" style="width: 100%; height: 100%; top: 10px; margin-top: 20px;">

                <tr valign="top" style="width: 100%; height: 100% ">
                    <td style="#{Metadaten.treeProperties.imageSticky?'width:600px;':''}">
                        <h:panelGroup rendered="#{Metadaten.modusAnsicht == 'Metadaten'}">
                            <ui:include src="includes/metseditor/metseditor_metadata.xhtml" />
                        </h:panelGroup>
                        <h:panelGroup rendered="#{Metadaten.modusAnsicht =='Strukturdaten'}">
                            <ui:include src="includes/metseditor/metseditor_structdata.xhtml" />
                        </h:panelGroup>
                        <h:panelGroup rendered="#{Metadaten.modusAnsicht =='Paginierung'}">
                            <ui:include src="includes/metseditor/metseditor_pagination.xhtml" />
                        </h:panelGroup>
                        <h:panelGroup rendered="#{Metadaten.modusAnsicht =='File'}">
                            <ui:include src="includes/metseditor/metseditor_file.xhtml" />
                        </h:panelGroup>
                    </td>

                        <td style="top: 10px;" id="BildArea2">
                    		<h:panelGroup rendered="#{Metadaten.bildAnzeigen==true and Metadaten.treeProperties.imageSticky}" style="position: fixed;top: 95px; left:#{Metadaten.treeWidth + 650}px">
                                <ui:include src="includes/metseditor/metseditor_image.xhtml" >
                                	<ui:param name="idPrefix" value="first"/>
                                </ui:include>
                            </h:panelGroup>

                         	<h:panelGroup rendered="#{Metadaten.bildAnzeigen==true and !Metadaten.treeProperties.imageSticky}" >
                         	 	<ui:include src="includes/metseditor/metseditor_image.xhtml">
                         	 		<ui:param name="idPrefix" value="second"/>
                         	 	</ui:include>
                         	</h:panelGroup>
                            
                        </td>
                </tr>
            </table>
        </h:panelGroup>


        <script type="text/javascript">
		function isIE() {
			var agent = navigator.userAgent.toLowerCase();
			var name = 'MSIE';
			if (agent.indexOf(name.toLowerCase()) > -1) {
				return true;
			}

			return false;
		}
		
		function focusForPicture() {
			if (isIE()) {
				for (i = 0; i &lt; document.getElementsByName("myCheckboxes").length; i++) {
					if (i == document.getElementById("hiddenBildNummer").value) {
						if (i+1 &lt; document.getElementsByName("myCheckboxes").length) {
							document.getElementsByName("myCheckboxes")[i + 1].focus();
						}
						document.getElementsByName("myCheckboxes")[i].focus();
					}
				}
			} else {
				for (i = 0; i &lt; document.getElementsByName("myCheckboxes").length; i++) {
					if (i == document.getElementById("hiddenBildNummer").value - 1) {
						if (i + 1 &lt; document.getElementsByName("myCheckboxes").length) {
							document.getElementsByName("myCheckboxes")[i + 1].focus();
						}
						document.getElementsByName("myCheckboxes")[i].focus();
					}
				}
			}
		}

			document.documentElement.onkeypress = function (event) {
				//alert("Sie haben die Taste mit dem Wert " + event.which + " gedrueckt");
				myButton = null;
				event = event || window.event; // IE sucks
				var key = event.which || event.keyCode; // IE uses .keyCode, Moz uses .which
				
				// -----------  previous20 image - cursor up
				if ((key == 76 || key == 12 || key == 40) &amp;&amp; // "L" "^L" or "l"
					event.shiftKey &amp;&amp; event.ctrlKey) {
					myButton = document.getElementById("formularBild:imageBack20");
					//goToImageBack();
					if (event.preventDefault) {
						event.preventDefault(); 
					}
					else {
						event.returnValue = false;
					} // IE sucks
				}
				
				// -----------  previous image - cursor left
				if ((key == 76 || key == 12 || key == 37) &amp;&amp; // "L" "^L" or "l"
					event.shiftKey &amp;&amp; event.ctrlKey) {
					myButton = document.getElementById("formularBild:imageBack");
					//goToImageBack();
					if (event.preventDefault) {
						event.preventDefault(); 
					}
					else {
						event.returnValue = false;
					} // IE sucks
				}
				
				// -----------  next image - cursor right
				if ((key == 76 || key == 12 || key == 39) &amp;&amp; // "L" "^L" or "l"
					event.shiftKey &amp;&amp; event.ctrlKey) {
					myButton = document.getElementById("formularBild:imageNext");
					//goToImageNext();
					if (event.preventDefault) {
						event.preventDefault(); 
					}
					else {
						event.returnValue = false;
					} // IE sucks
				}
				
				// -----------  next image - cursor down
				if ((key == 76 || key == 12 || key == 38) &amp;&amp; // "L" "^L" or "l"
					event.shiftKey &amp;&amp; event.ctrlKey) {
					myButton = document.getElementById("formularBild:imageNext20");
					//goToImageNext();
					if (event.preventDefault) {
						event.preventDefault(); 
					}
					else {
						event.returnValue = false;
					} // IE sucks
				}
				
				// -----------  first image - pos1
				if ((key == 76 || key == 12 || key == 36) &amp;&amp; // "L" "^L" or "l"
					event.shiftKey &amp;&amp; event.ctrlKey) {
					myButton = document.getElementById("formularBild:imageFirst");
					//goToImageNext();
					if (event.preventDefault) {
						event.preventDefault(); 
					}
					else {
						event.returnValue = false;
					} // IE sucks
				}
				
				// -----------  last image - end
				if ((key == 76 || key == 12 || key == 35) &amp;&amp; // "L" "^L" or "l"
					event.shiftKey &amp;&amp; event.ctrlKey) {
					myButton = document.getElementById("formularBild:imageLast");
					//goToImageNext();
					if (event.preventDefault) {
						event.preventDefault(); 
					}
					else {
						event.returnValue = false;
					} // IE sucks
				}
				
				// ---------- click my Button
				try{
					if (myButton!=null)
						myButton.click();
				}catch(e){}	
			}
			
			
			function paginierungWertAnzeigen(element) {
				var inputBoxElement = document.getElementById("paginierungWert");
				inputBoxElement.style.display = (element.value == 3 ? 'none' : '');
				if (element.value == 2 || element.value == 5) {
					inputBoxElement.value = 'I';
				}
				if (element.value == 1 || element.value == 4) {
					inputBoxElement.value = '1';
				}
			}
				</script>
    </ui:define>

</ui:composition>





